import{Rc as j,Sc as x,Tc as I,Uc as L,Vc as R,Wc as U,Xc as $,Za as _,r as d,s as y,u as l,va as c}from"./chunk-CMRSBBFI.js";import{Ac as S,Qc as b,X as n,a as h,b as f,ba as p,ea as s,m as o}from"./chunk-CPQ7MZ6M.js";var E=(()=>{class a{constructor(e){this.http=e,this.skeletonLoader=!1}getOrders(e){return this.http.get(`${c.URL}/order`,{params:e})}viewOrder(e){return this.http.get(`${c.URL}/order/${e}`)}checkout(e){return this.http.post(`${c.URL}/checkout`,e)}placeOrder(e){return this.http.post(`${c.URL}/order`,e)}rePayment(e){return this.http.post(`${c.URL}/rePayment`,e)}orderTracking(e){return this.http.get(`${c.URL}/trackOrder`,{params:e})}downloadInvoice(e){let r={};return this.http.post(`${c.URL}/order/invoice`,e,{responseType:"blob"})}static{this.\u0275fac=function(r){return new(r||a)(s(S))}}static{this.\u0275prov=p({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var i=class O{constructor(t,e,r){this.notificationService=t,this.router=e,this.orderService=r}static order(t){return t.order}static selectedOrder(t){return t.selectedOrder}static checkout(t){return t.checkout}getOrders(t,e){return this.orderService.getOrders(e?.payload).pipe(n({next:r=>{t.patchState({order:{data:r.data,total:r?.total?r?.total:r.data?.length}})},error:r=>{throw new Error(r?.error?.message)}}))}viewOrder(t,{id:e}){return this.orderService.skeletonLoader=!0,this.orderService.viewOrder(e).pipe(n({next:r=>{let u=t.getState();t.patchState(f(h({},u),{selectedOrder:r}))},error:r=>{throw new Error(r?.error?.message)},complete:()=>{this.orderService.skeletonLoader=!1}}))}checkout(t,e){return this.orderService.checkout(e?.payload).pipe(n({next:r=>{let u=t.getState();t.patchState(f(h({},u),{checkout:r}))},error:r=>{throw new Error(r?.error?.message)}}))}placeOrder(t,e){return this.orderService.placeOrder(e?.payload).pipe(n({next:r=>{(e.payload.payment_method=="cod"||e.payload.payment_method=="bank_transfer")&&!r.is_guest?this.router.navigateByUrl(`/account/order/details/${r.order_number}`):(e.payload.payment_method=="cod"||e.payload.payment_method=="bank_transfer")&&r.is_guest?this.router.navigate(["order/details"],{queryParams:{order_number:r.order_number,email_or_phone:e?.payload.email}}):window.open(r.url,"_self")},error:r=>{throw new Error(r?.error?.message)}}))}rePayment(t,e){return this.orderService.rePayment(e.payload).pipe(n({next:r=>{(e.payload.payment_method=="cod"||e.payload.payment_method=="bank_transfer")&&!r.is_guest?this.router.navigateByUrl(`/account/order/details/${r.order_number}`):(e.payload.payment_method=="cod"||e.payload.payment_method=="bank_transfer")&&r.is_guest?this.router.navigate(["order/details"],{queryParams:{order_number:r.order_number,email_or_phone:r.email}}):window.open(r.url,"_self")},error:r=>{throw new Error(r?.error?.message)}}))}orderTracking(t,e){return this.notificationService.notification=!1,this.orderService.orderTracking(e.payload).pipe(n({next:r=>{let u=t.getState();t.patchState(f(h({},u),{selectedOrder:r}))},error:r=>{throw new Error(r?.error?.message)}}))}downloadInvoice(t,e){return this.orderService.downloadInvoice(e.payload).pipe(n({next:r=>{let u=new Blob([r],{type:"pdf"}),k=window.URL.createObjectURL(u),w=document.createElement("a");w.href=k,w.download=`invoice-${e.payload.order_number}.pdf`,w.click(),window.URL.revokeObjectURL(k)},error:r=>{throw new Error(r?.error?.message)}}))}static{this.\u0275fac=function(e){return new(e||O)(s(_),s(b),s(E))}}static{this.\u0275prov=p({token:O,factory:O.\u0275fac})}};o([d(j)],i.prototype,"getOrders",null);o([d(x)],i.prototype,"viewOrder",null);o([d(I)],i.prototype,"checkout",null);o([d(L)],i.prototype,"placeOrder",null);o([d(R)],i.prototype,"rePayment",null);o([d(U)],i.prototype,"orderTracking",null);o([d($)],i.prototype,"downloadInvoice",null);o([l()],i,"order",null);o([l()],i,"selectedOrder",null);o([l()],i,"checkout",null);i=o([y({name:"order",defaults:{order:{data:[],total:0},selectedOrder:null,checkout:null}})],i);var P=(()=>{class a{static{this.type="[Order Status] Get"}constructor(e){this.payload=e}}return a})();var T=(()=>{class a{constructor(e){this.http=e}getOrderStatus(e){return this.http.get(`${c.URL}/orderStatus`,{params:e})}static{this.\u0275fac=function(r){return new(r||a)(s(S))}}static{this.\u0275prov=p({token:a,factory:a.\u0275fac,providedIn:"root"})}}return a})();var m=class v{constructor(t){this.orderStatusService=t}static orderStatus(t){return t.orderStatus}static orderStatuses(t){return t.orderStatus.data.map(e=>({label:e?.name,value:e?.id}))}static selectedOrderStatus(t){return t.selectedOrderStatus}getOrderStatus(t,e){return this.orderStatusService.getOrderStatus(e.payload).pipe(n({next:r=>{t.patchState({orderStatus:{data:r.data,total:r?.total?r?.total:r.data?.length}})},error:r=>{throw new Error(r?.error?.message)}}))}static{this.\u0275fac=function(e){return new(e||v)(s(T))}}static{this.\u0275prov=p({token:v,factory:v.\u0275fac})}};o([d(P)],m.prototype,"getOrderStatus",null);o([l()],m,"orderStatus",null);o([l()],m,"orderStatuses",null);o([l()],m,"selectedOrderStatus",null);m=o([y({name:"orderStatus",defaults:{orderStatus:{data:[],total:0},selectedOrderStatus:null}})],m);export{i as a,P as b,m as c};
